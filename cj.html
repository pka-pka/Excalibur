<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./cj.css" />
</head>
<body background="https://sast.njupt.edu.cn/public/img/lb3.png" >
    <div class="zt">
        <a>喜闻乐见的破冰会抽奖</a>
    </div>
    <div class="ipt">
        <input type="file" class="f1" onchange="importf(this)" style="opacity: 0;">       
    </div>
    <div class="f2">
        <button class="bt">从Excel表格导入</button>
    </div>
    <div class="f3">
        <button onclick="cj()" class = "f4">抽奖样例</button>
        <input type="number" id = "rs" placeholder="请输入要抽取的人数（不超过15）">
    </div>
    <div class="sc" id = "jg">
    </div>    
    <script src="http://libs.baidu.com/jquery/1.9.0/jquery.js"></script>
    <script src="./xlsx.full.min.js"></script>
    <script>
        var md= document.getElementById('jg');
        $(".bt").click(function(){$(".f1").click();});
        $(document).keydown(function(event){if(event.keyCode==13){cj()}})
        let name = ["阿尔托莉雅","薇尔列特","两仪式","托尔","平泽唯","琴吹䌷","田井中律","秋山澪","中野梓","小林","藤原千花","玉子","山内樱良","西宫硝子","莫德雷德"];
        function cj(){
            let t = 0;
            let m = 0;
            let j = 0;
            let c = new Array
            var n = document.getElementById("rs").value;
            $(".nm").remove();
            if( n < 16 && n > 0){
                c[t]=Math.floor(Math.random()*15);
                for(;t < n ;t++){
                   m=Math.floor(Math.random()*15);
                   for(j = 0;j<t;j++){
                       if(m!=c[j])
                          c[t] = m;
                       else{
                           t--;
                           break;
                       }
                   } 
                }
                let q = 1;
                c.forEach( value=> {
                    var div = document.createElement('div');
                    div.innerHTML = '<a>' + name[value] + '</a>';
                    div.className = "nm";
                    q++;
                    if(q==5||q==10){
                        var br = document.createElement('br');
                        md.appendChild(br);
                    }
                    md.appendChild(div);
                    $(".nm").fadeIn("slow");
                });
            }
            else{
                alert("输入不合法");    
            } 
        } 
    </script>
</body> 
</html>
